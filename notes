Требования:

"Если в каком-либо городе нет количества или цены для данного товара, или он отсутствует вообще, в соответствующие поля
 ставится 0. Если в разных файлах у одного и того же товара имеются несовпадающие поля, например, название или вес,
 можно использовать любое из них для записи в БД."

и

"При последующем запуске скрипт должен обновлять данные по товарам, находя соответствие по полю Код (то есть обновлять то,
что уже есть, а не добавлять новые)."

несколько противоречат друг другу. Буквально, первое требует не обновлять не ключевые атрибуты, если запись была
создана или обновлена в ТЕКУЩЕМ ЗАПУСКЕ скрипта.
Второе же требует обновлять не ключевые атрибуты, если запись была создана или обновлена в одном из ПРЕДЫДУЩИХ ЗАПУСКОВ скрипта.

Конечно, этим требованием можно удовлетворить, если хранить в каждой записи некоторый идентификатор запуска скрипта
(например, дату+время). Но в таком решении мало практического смысла.

Поэтому я выбираю для руководства второе требование и буду всегда обновлять неключеые атрибуты.
